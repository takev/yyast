<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>YYAST</title>
<link rel="stylesheet" type="text/css" href="style/base.css"/>
</head>
<body>
<h1>YYAST - Documentation</h1>
<p class="author">by Take Vos (2013)</p>
<p>YYAST is a library which completes lex and yacc by adding an abstract syntax tree (AST) generator.
The saved AST is designed to be easily parsed by compilers.
</p>

<h2>File format</h2>
<p>This is a description of version 2 of the file format. Version 1 was not documented.
</p>
<p>All fields are naturally aligned.
</p>

<h3>File Header</h3>

<table>
<tr><th>type</th>    <th>description</th></tr>
<tr><td>EightCC</td> <td>Magic for this file format. 'yyast 02'</td></tr>
<tr><td>EightCC</td> <td>Magic for the parsed language.</td></tr>
<tr><td>uint32_t</td><td>Nr of parsed file names.</td></tr>
<tr><td>UTF-8[]</td> <td>parsed file names.</td></tr>
<tr><td>Node</td>    <td>AST of parsed document.</td></tr>
</table>

<h3>Node Header</h3>

<table>
<tr><th>type</th>     <th>description</th></tr>
<tr><td>EightCC</td>  <td>Magic for this node. 64 bit aligned</td></tr>
<tr><td>uint64_t</td> <td>Data size.</td></tr>
<tr><td>uint32_t</td> <td>Line number. The top mode line is zero.</td></tr>
<tr><td>uint32_t</td> <td>Column number. The left most column is zero</td></tr>
<tr><td>uint32_t</td> <td>File number. The first file (the main file) is zero.</td></tr>
<tr><td>uint16_t</td> <td>Reserved, must be zero.</td></tr>
<tr><td>uint8_t</td>  <td>Reserved, must be zero.</td></tr>
<tr><td>uint8_t</td>  <td>Node type.</td></tr>
<tr><td></td>         <td>Data. 64 bit aligned</td></tr>
</table>

<h3>Node type 0: branch node</h3>
<p>A branch node contains as its data, a ordered list of child nodes.
</p>

<h3>Node type 1: empty leaf node</h3>
<p>A leaf node containing no data.
</p>

<h3>Node type 2: text</h3>
<p>A text node contains a null terminated UTF-8 string. The string may need to be padded with additional null
bytes to yield data that is a multiple of 8 bytes in size. The data size will include the additional padding.
</p>

<h3>Node type 3: positive integer</h3>
<p>An unsigned integer represented in big endian format. The size of the integer is a multiple of 8 bytes.
</p>

<h3>Node type 4: negative integer</h3>
<p>An unsigned integer represented in big endian format. The size of the integer is a multiple of 8 bytes.
The integer has an implicit negative sign.
</p>

<h3>Node type 5: IEEE 754 binary floating point</h3>
<p>The real number is represented in binary64 or binary128 format, in big endian format (sign/exponent first, mantissa last).
</p>

<h3>Node type 6: IEEE 754 decimal floating point</h3>
<p>The real number is represented in decimal64 or decimal128 format, in big endian format (sign/exponent first, mantissa last).
</p>

</body>
</html>
